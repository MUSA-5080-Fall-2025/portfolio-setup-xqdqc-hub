{"title":"Assignment 2: Spatial Analysis and Visualization","markdown":{"yaml":{"title":"Assignment 2: Spatial Analysis and Visualization","subtitle":"Healthcare Access and Equity in Pennsylvania","author":"Qianmu Zheng","date":"today","format":{"html":{"code-fold":false,"toc":true,"toc-location":"left","theme":"cosmo","embed-resources":true}},"execute":{"warning":false,"message":false}},"headingText":"Assignment Overview","containsRefs":false,"markdown":"\n\n\n**Learning Objectives:**\n- Apply spatial operations to answer policy-relevant research questions\n- Integrate census demographic data with spatial analysis\n- Create publication-quality visualizations and maps\n- Work with spatial data from multiple sources\n- Communicate findings effectively for policy audiences\n\n---\n\n## Part 1: Healthcare Access for Vulnerable Populations\n\n### Research Question\n\n**Which Pennsylvania counties have the highest proportion of vulnerable populations (elderly + low-income) living far from hospitals?**\n\n\n#### Step 1: Data Collection (5 points)\n\n```{r}\n# Load required packages\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(tigris)\nlibrary(tidycensus)\nlibrary(scales)\nlibrary(patchwork)\nlibrary(here)\n# Load spatial data\ndata_path <- \"D:/Desktop/musa/5080_policy/5080/MUSA-5080-Fall-2025/lectures/week-04/data\"\ncensus_api_key(\"940dffa67b928a0518accaf8839aa7b4762b11ab\")\n\npa_counties <- st_read(file.path(data_path, \"Pennsylvania_County_Boundaries.shp\"))\nhospitals <- st_read(file.path(data_path, \"hospitals.geojson\"))\ncensus_tracts <- tracts(state = \"PA\", cb = TRUE)\n\n# Check that all data loaded correctly\nhospitals <- st_transform(hospitals, st_crs(pa_counties))\ncensus_tracts <- st_transform(census_tracts, st_crs(pa_counties))\n\nhead(pa_counties)\nhead(hospitals)\nhead(census_tracts)\n```\n\n```{r}\nnum_hospitals <- nrow(hospitals)\ncat(\"Number of hospitals in dataset:\", num_hospitals, \"\\n\")\n\nnum_tracts <- nrow(census_tracts)\ncat(\"Number of census tracts in dataset:\", num_tracts, \"\\n\")\n\ncat(\"\\n---- Coordinate Reference Systems ----\\n\")\ncat(\"Counties CRS:\\n\"); print(st_crs(pa_counties))\ncat(\"\\nHospitals CRS:\\n\"); print(st_crs(hospitals))\ncat(\"\\nCensus Tracts CRS:\\n\"); print(st_crs(census_tracts))\n```\n\n---\n\n#### Step 2: Get Demographic Data \n\nUse `tidycensus` to download tract-level demographic data for Pennsylvania.\n\n```{r}\n# Get demographic data from ACS\nlibrary(tidycensus)\nlibrary(dplyr)\nlibrary(sf)\n\nacs_year <- 2022\n\npa_basic <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    median_income = \"B19013_001\"\n  ),\n  year = acs_year,\n  survey = \"acs5\",\n  geometry = FALSE,\n  output = \"wide\"\n)\n\npa_age <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  variables = c(\n    male_65_66 = \"B01001_020\",\n    male_67_69 = \"B01001_021\",\n    male_70_74 = \"B01001_022\",\n    male_75_79 = \"B01001_023\",\n    male_80_84 = \"B01001_024\",\n    male_85plus = \"B01001_025\",\n    female_65_66 = \"B01001_044\",\n    female_67_69 = \"B01001_045\",\n    female_70_74 = \"B01001_046\",\n    female_75_79 = \"B01001_047\",\n    female_80_84 = \"B01001_048\",\n    female_85plus = \"B01001_049\"\n  ),\n  year = acs_year,\n  survey = \"acs5\",\n  geometry = FALSE\n)\n\npa_age_summary <- pa_age %>%\n  group_by(GEOID) %>%\n  summarize(pop_65_over = sum(estimate, na.rm = TRUE))\n\npa_demo <- pa_basic %>%\n  left_join(pa_age_summary, by = \"GEOID\") %>%\n  select(GEOID, total_popE, median_incomeE, pop_65_over) %>%\n  rename(\n    total_pop = total_popE,\n    median_income = median_incomeE\n  )\n\n# Join to tract boundaries\ncensus_tracts_demo <- census_tracts %>%\n  left_join(pa_demo, by = c(\"GEOID\" = \"GEOID\"))\n\n\n# What year of ACS data?\ncat(\"ACS Year Used:\", acs_year, \"\\n\")\n\n# How many tracts have missing income data?\nmissing_income <- sum(is.na(census_tracts_demo$median_income))\ncat(\"Number of tracts with missing income data:\", missing_income, \"\\n\")\n\n# What is the median income across all PA census tracts?\noverall_median_income <- median(census_tracts_demo$median_income, na.rm = TRUE)\ncat(\"Median income across all PA tracts:\", dollar(overall_median_income), \"\\n\")\n\n```\n\n\n---\n\n#### Step 3: Define Vulnerable Populations \n\nIdentify census tracts with vulnerable populations based on TWO criteria:\n1. Low median household income (choose an appropriate threshold)\n2. Significant elderly population (choose an appropriate threshold)\n\n```{r}\n#### Step 3: Define Vulnerable Populations ----\n\nincome_threshold <- 50000\nelderly_threshold <- 0.15\n\ncensus_tracts_demo <- census_tracts_demo %>%\n  mutate(\n    pct_elderly =  pop_65_over/ total_pop\n  )\n\nvulnerable_tracts <- census_tracts_demo %>%\n  filter(\n    median_income < income_threshold &\n    pct_elderly > elderly_threshold\n  )\n\nnum_vulnerable <- nrow(vulnerable_tracts)\ntotal_tracts <- nrow(census_tracts_demo)\npct_vulnerable <- (num_vulnerable / total_tracts) * 100\n\ncat(\"Income threshold:\", income_threshold, \"\\n\")\ncat(\"Elderly population threshold:\", elderly_threshold * 100, \"%\\n\")\ncat(\"Number of vulnerable tracts:\", num_vulnerable, \"\\n\")\ncat(\"Percentage of PA tracts considered vulnerable:\", round(pct_vulnerable, 2), \"%\\n\")\n\n```\n\n---\n\n#### Step 4: Calculate Distance to Hospitals \n\nFor each vulnerable tract, calculate the distance to the nearest hospital.\n\n```{r}\nlibrary(units)\n# Transform to appropriate projected CRS\nprojected_crs <- 26918\n\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts, crs = projected_crs)\nhospitals_proj <- st_transform(hospitals, crs = projected_crs)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\n\ndist_matrix <- st_distance(tract_centroids, hospitals_proj)\nnearest_hospital_dist_m <- apply(dist_matrix, 1, min)\n\nnearest_hospital_dist_miles <- as.numeric(nearest_hospital_dist_m) / 1609.34\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(distance_to_hospital_miles = nearest_hospital_dist_miles)\n\navg_distance <- mean(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nmax_distance <- max(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nnum_over_15 <- sum(vulnerable_tracts_proj$distance_to_hospital_miles > 15, na.rm = TRUE)\n\ncat(\"Average distance to nearest hospital (miles):\", round(avg_distance, 2), \"\\n\")\ncat(\"Maximum distance to nearest hospital (miles):\", round(max_distance, 2), \"\\n\")\ncat(\"Number of vulnerable tracts >15 miles from hospital:\", num_over_15, \"\\n\")\n\n```\n\n---\n\n#### Step 5: Identify Underserved Areas \n\nDefine \"underserved\" as vulnerable tracts that are more than 15 miles from the nearest hospital.\n\n```{r}\n# Create underserved variable\n\nlibrary(dplyr)\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(\n    underserved = distance_to_hospital_miles > 15\n  )\n\nnum_underserved <- sum(vulnerable_tracts_proj$underserved, na.rm = TRUE)\ntotal_vulnerable <- nrow(vulnerable_tracts_proj)\npct_underserved <- (num_underserved / total_vulnerable) * 100\n\ncat(\"Number of underserved vulnerable tracts:\", num_underserved, \"\\n\")\ncat(\"Percentage of vulnerable tracts that are underserved:\", round(pct_underserved, 2), \"%\\n\")\n\n```\n\n---\n\n#### Step 6: Aggregate to County Level\n\nUse spatial joins and aggregation to calculate county-level statistics about vulnerable populations and hospital access.\n\n```{r}\n# Spatial join tracts to counties\n#### Step 6: Aggregate to County Level ----\n\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts_proj, st_crs(pa_counties))\n\ntracts_with_county <- st_join(vulnerable_tracts_proj, pa_counties, join = st_intersects, left = FALSE)\n\nnames(tracts_with_county)\n\ncounty_summary <- tracts_with_county %>%\n  st_drop_geometry() %>%\n  group_by(NAMELSADCO) %>%\n  summarize(\n    num_vulnerable_tracts = n(),\n    num_underserved_tracts = sum(underserved, na.rm = TRUE),\n    pct_underserved = (num_underserved_tracts / num_vulnerable_tracts) * 100,\n    avg_distance_miles = mean(distance_to_hospital_miles, na.rm = TRUE),\n    total_vulnerable_pop = sum(total_pop, na.rm = TRUE)\n  ) %>%\n  arrange(desc(pct_underserved))\n\nhead(county_summary)\n\n# Aggregate statistics by county\n\n```\n\n\n```{r}\ntop5_underserved <- county_summary %>%\n  arrange(desc(pct_underserved)) %>%\n  slice(1:5)\nprint(top5_underserved)\n\n```\n```{r}\ntop_vuln_far <- county_summary %>%\n  arrange(desc(total_vulnerable_pop)) %>%\n  slice(1:5)\nprint(top_vuln_far)\n\n```\nMost underserved counties tend to be located in rural northern and western Pennsylvania, where hospital density is lower and population centers are more dispersed. Urban counties (like Philadelphia or Allegheny) show fewer underserved tracts due to higher hospital accessibility.\n\n---\n\n#### Step 7: Create Summary Table \n\nCreate a professional table showing the top 10 priority counties for healthcare investment.\n\n```{r}\n# Create and format priority counties table\n#### Step 7: Create Summary Table ----\n\nlibrary(knitr)\nlibrary(scales)\n\npriority_metric <- \"pct_underserved\"\n\npriority_counties <- county_summary %>%\n  arrange(desc(!!sym(priority_metric))) %>%\n  slice(1:10) %>%\n  mutate(\n    num_vulnerable_tracts = comma(num_vulnerable_tracts),\n    num_underserved_tracts = comma(num_underserved_tracts),\n    pct_underserved = percent(pct_underserved / 100, accuracy = 0.1),\n    avg_distance_miles = round(avg_distance_miles, 1),\n    total_vulnerable_pop = comma(total_vulnerable_pop)\n  ) %>%\n  rename(\n    `County` = NAMELSADCO,\n    `Vulnerable Tracts` = num_vulnerable_tracts,\n    `Underserved Tracts` = num_underserved_tracts,\n    `% Underserved` = pct_underserved,\n    `Avg Distance (mi)` = avg_distance_miles,\n    `Total Vulnerable Population` = total_vulnerable_pop\n  )\n\nkable(\n  priority_counties,\n  caption = \"Table 1. Top 10 Pennsylvania Counties Prioritized for Healthcare Investment\",\n  align = \"lccccc\",\n  format = \"markdown\"\n)\n\n```\n\n---\n\n## Part 2: Comprehensive Visualization \n\nUsing the skills from Week 3 (Data Visualization), create publication-quality maps and charts.\n\n### Map 1: County-Level Choropleth \n\nCreate a choropleth map showing healthcare access challenges at the county level.\n\n```{r}\nlibrary(stringr)\n\ncounty_summary <- county_summary %>%\n  mutate(NAMELSADCO = str_replace(NAMELSADCO, \" County$\", \"\"))\n\n```\n\n```{r}\nView(pa_counties)\nView(county_summary)\n```\n\n\n```{r}\n# Create county-level access map\n#### Part 2: County-Level Choropleth ----\n\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(scales)\n\npa_counties_proj <- st_transform(pa_counties, 26918)\nhospitals_proj <- st_transform(hospitals, 26918)\n\n\ncounty_summary_map <- pa_counties_proj %>%\n  mutate(COUNTY_NAM = tolower(COUNTY_NAM)) %>%\n  left_join(\n    county_summary %>%\n      mutate(NAMELSADCO = tolower(NAMELSADCO)),\n    by = c(\"COUNTY_NAM\" = \"NAMELSADCO\")\n  )\n\n\nggplot() +\n  geom_sf(\n    data = county_summary_map,\n    aes(fill = pct_underserved),\n    color = \"white\",\n    size = 0.2\n  ) +\n\n  scale_fill_gradient(\n    low = \"#DEEBF7\",\n    high = \"#2171B5\",\n    name = \"% Underserved Tracts\",\n    labels = function(x) paste0(round(x, 0), \"%\"),\n    na.value = \"grey90\"\n  ) +\n\n  labs(\n    title = \"Healthcare Access Challenges Across Pennsylvania Counties\",\n    subtitle = \"Percentage of vulnerable tracts that are more than 15 miles from the nearest hospital\",\n    caption = \"Data sources: ACS 2022 (via tidycensus), Pennsylvania hospital data (Week 4 lecture)\"\n  ) +\n\n  theme_void(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 11, hjust = 0.5),\n    plot.caption = element_text(size = 9, hjust = 0.95, color = \"gray40\"),\n    legend.position = \"right\",\n    legend.title = element_text(size = 10, face = \"bold\"),\n    legend.text = element_text(size = 9)\n  )\n\n\n\n```\n\n---\n\n### Map 2: Detailed Vulnerability Map \n\nCreate a map highlighting underserved vulnerable tracts.\n\n```{r}\n# Create detailed tract-level map\n#### Part 2: Map 2 - Detailed Vulnerability Map ----\n\npa_counties_proj <- st_transform(pa_counties, 26918)\nhospitals_proj <- st_transform(hospitals, 26918)\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts_proj, 26918)\n\ntract_map_data <- vulnerable_tracts_proj %>%\n  mutate(\n    tract_status = case_when(\n      underserved ~ \"Underserved Vulnerable Tract\",\n      TRUE ~ \"Other Vulnerable Tract\"\n    )\n  )\n\nggplot() +\n  geom_sf(data = pa_counties_proj, fill = \"gray95\", color = \"white\", size = 0.3) +\n  \n  geom_sf(\n    data = tract_map_data,\n    aes(fill = tract_status),\n    color = NA,\n    alpha = 0.9\n  ) +\n  \n  geom_sf(\n    data = hospitals_proj,\n    color = \"red\",\n    size = 1.2,\n    alpha = 0.8\n  ) +\n  \n  scale_fill_manual(\n    values = c(\n      \"Underserved Vulnerable Tract\" = \"#d73027\",\n      \"Other Vulnerable Tract\" = \"#fee090\"\n    ),\n    name = \"Tract Type\"\n  ) +\n  \n  labs(\n    title = \"Underserved Vulnerable Tracts in Pennsylvania\",\n    subtitle = \"Vulnerable tracts (low income & elderly) more than 15 miles from the nearest hospital are shown in red\",\n    caption = \"Data: ACS 2022 (via tidycensus) and PA hospital data (Week 4 lecture)\"\n  ) +\n  \n  theme_void(base_size = 11) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 11, hjust = 0.5, color = \"gray20\"),\n    plot.caption = element_text(size = 9, color = \"gray40\", hjust = 0.95),\n    legend.position = \"bottom\",\n    legend.title = element_text(face = \"bold\", size = 10),\n    legend.text = element_text(size = 9)\n  )\n\n```\n\n---\n\n### Chart: Distribution Analysis\n\nCreate a visualization showing the distribution of distances to hospitals for vulnerable populations.\n\n```{r}\n# Create distribution visualization\n#### Chart: Distribution Analysis ----\n\nlibrary(ggplot2)\nlibrary(scales)\n\nggplot(vulnerable_tracts_proj, aes(x = distance_to_hospital_miles)) +\n  geom_histogram(\n    aes(y = after_stat(density)),\n    bins = 30,\n    fill = \"#74c476\",\n    color = \"white\",\n    alpha = 0.8\n  ) +\n  geom_density(color = \"#006d2c\", linewidth = 1) +\n  geom_vline(xintercept = 15, linetype = \"dashed\", color = \"red\", linewidth = 1) +\n  labs(\n    title = \"Distribution of Distances to Nearest Hospital for Vulnerable Tracts\",\n    subtitle = \"Dashed red line indicates the 15-mile underserved threshold\",\n    x = \"Distance to Nearest Hospital (miles)\",\n    y = \"Density\",\n    caption = \"Data: ACS 2022 (via tidycensus) and PA hospital data (Week 4 lecture)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n    plot.subtitle = element_text(size = 11, hjust = 0.5, color = \"gray30\"),\n    plot.caption = element_text(size = 9, color = \"gray40\", hjust = 0.95),\n    axis.title = element_text(face = \"bold\")\n  )\n\n\n\n\n```\n\n---\n\n## Part 3: Bring Your Own Data Analysis \n\nChoose your own additional spatial dataset and conduct a supplementary analysis.\n\n1. **Find and load additional data**\n   - Document your data source\n   - Check and standardize the CRS\n   - Provide basic summary statistics\n\n```{r}\n# Load your additional dataset\nbase_path = \"D:\\\\Desktop\\\\musa\\\\5080_policy\\\\portfolio-setup-xqdqc-hub\\\\assignments\\\\assignment_2\\\\data\"\n\nschools <- st_read(file.path(base_path, \"Schools\\\\Schools.shp\"))\ncrime <- st_read(file.path(base_path,\"incidents_part1_part2\\\\incidents_part1_part2.shp\"))\nbike_net <- st_read(file.path(base_path,\"Bike_Network\\\\Bike_Network.shp\"))\n```\n```{r}\ncat(\"Schools CRS:\\n\"); print(st_crs(schools))\ncat(\"\\nCrime Incidents CRS:\\n\"); print(st_crs(crime))\ncat(\"\\nBike Network CRS:\\n\"); print(st_crs(bike_net))\n```\n```{r}\ncrime <- st_transform(crime, 3857)\n```\n\n```{r}\ncat(\"\\nSchools:\\n\")\ncat(\"Number of schools:\", nrow(schools), \"\\n\")\nprint(st_geometry_type(schools) %>% table())\nprint(summary(st_bbox(schools)))\n\ncat(\"\\nCrime Incidents:\\n\")\ncat(\"Number of records:\", nrow(crime), \"\\n\")\nprint(st_geometry_type(crime) %>% table())\nprint(summary(st_bbox(crime)))\n\ncat(\"\\nBike Network:\\n\")\ncat(\"Number of segments:\", nrow(bike_net), \"\\n\")\nprint(st_geometry_type(bike_net) %>% table())\nprint(summary(st_bbox(bike_net)))\n```\n\n**Questions to answer:**\n- What dataset did you choose and why?\n\nI have chosen School dataset because I'm interested in young children issue.\n\n- What is the data source and date?\n\nCrime Incidents is in 2024, and I also have school dataset and bike network dataset.\n\n- How many features does it contain?\n\nNumber of schools is 495, number of crime records is 160388, number of bike network segments is 5225.\n\n- What CRS is it in? Did you need to transform it?\n\nThe CRS of schools and bike network data is EPSG 3857, the CRS of crime data is EPSG 4326. So I have got crime data transformed.\n\n---\n\n2. **Pose a research question**\n\nWrite a clear research statement that your analysis will answer.\n\nThis analysis investigates whether school zones in Philadelphia are safe environments, by examining the number of nearby crime incidents.\n\n---\n\n3. **Conduct spatial analysis**\n\n```{r}\n# Your spatial analysis\nschool_buffers <- st_buffer(schools, dist = 1000)\n\ncrime_join <- st_join(crime, school_buffers, join = st_within, left = FALSE)\n```\n\n```{r}\nView(crime_join)\n```\n\n\n```{r}\nschool_crime_count <- crime_join %>%\n  st_drop_geometry() %>%\n  group_by(school_nam) %>%\n  summarize(crime_count = n())\n\nschools_with_crime <- schools %>%\n  left_join(school_crime_count, by = \"school_nam\") %>%\n  mutate(crime_count = replace_na(crime_count, 0))\n```\n\n```{r}\nhead(schools_with_crime)\n```\n\n```{r}\nbike_in_buffers <- st_intersection(bike_net, school_buffers)\n\nbike_coverage <- bike_in_buffers %>%\n  st_drop_geometry() %>%\n  group_by(school_nam) %>%\n  summarize(bike_miles = sum(st_length(bike_in_buffers) / 5280))\n\nschools_with_bike <- schools_with_crime %>%\n  left_join(bike_coverage, by = c(\"school_nam\")) %>%\n  mutate(bike_miles = replace_na(bike_miles))\n\nhead(schools_with_bike)\n```\n\n\n```{r}\nsummary_tbl <- schools_with_bike %>%\n  st_drop_geometry() %>%\n  summarize(\n    total_schools = n(),\n    avg_crime = mean(crime_count, na.rm = TRUE),\n    avg_bike = mean(bike_miles, na.rm = TRUE)\n  )\n\nprint(summary_tbl)\n```\n\n\n\n```{r}\nggplot(data = schools_with_crime) +\n  geom_sf(aes(color = crime_count), size = 2) +\n  scale_color_viridis_c(\n    option = \"plasma\",\n    trans = \"sqrt\",\n    name = \"Crime Count\"\n  ) +\n  labs(\n    title = \"Crime Incidents Within 1000ft of Philadelphia Schools\",\n    subtitle = \"Each point represents a school, colored by number of nearby crime incidents\",\n    caption = \"Data: OpenDataPhilly | Analysis: MUSA 5080 Assignment 3\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 10, hjust = 0.5, color = \"gray30\"),\n    legend.position = \"right\"\n  )\n\n```\n\n\n```{r}\nggplot(schools_with_crime, aes(x = crime_count)) +\n  geom_histogram(\n    bins = 30,\n    fill = \"pink\",\n    color = \"white\",\n    alpha = 0.8\n  ) +\n  labs(\n    title = \"Distribution of Crime Incidents Within 1000ft of Schools\",\n    subtitle = \"Each bar represents the number of schools by nearby crime count\",\n    x = \"Number of Crime Incidents (within 1000ft)\",\n    y = \"Number of Schools\",\n    caption = \"Data: OpenDataPhilly | Analysis: MUSA 5080 Assignment 3\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 10, hjust = 0.5, color = \"gray30\"),\n    plot.caption = element_text(size = 8, color = \"gray50\", hjust = 0.95)\n  )\n\n```\n\n**My interpretation:**\nThe majority of Philadelphia schools experience a moderate number of nearby crime incidents, with most falling below 2,000 cases within a 1,000-ft radius. However, a few schools stand out as clear hotspots, with significantly higher counts exceeding 6,000 incidents, concentrated primarily in central and southern parts of the city. The histogram confirms this right-skewed distribution, where a small proportion of schools account for a disproportionately large share of nearby crimes. These findings suggest that while most school zones remain relatively safe, targeted safety interventions and “Safe Routes to School” programs should prioritize the high-crime areas identified in the analysis.\n","srcMarkdownNoYaml":"\n\n## Assignment Overview\n\n**Learning Objectives:**\n- Apply spatial operations to answer policy-relevant research questions\n- Integrate census demographic data with spatial analysis\n- Create publication-quality visualizations and maps\n- Work with spatial data from multiple sources\n- Communicate findings effectively for policy audiences\n\n---\n\n## Part 1: Healthcare Access for Vulnerable Populations\n\n### Research Question\n\n**Which Pennsylvania counties have the highest proportion of vulnerable populations (elderly + low-income) living far from hospitals?**\n\n\n#### Step 1: Data Collection (5 points)\n\n```{r}\n# Load required packages\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(tigris)\nlibrary(tidycensus)\nlibrary(scales)\nlibrary(patchwork)\nlibrary(here)\n# Load spatial data\ndata_path <- \"D:/Desktop/musa/5080_policy/5080/MUSA-5080-Fall-2025/lectures/week-04/data\"\ncensus_api_key(\"940dffa67b928a0518accaf8839aa7b4762b11ab\")\n\npa_counties <- st_read(file.path(data_path, \"Pennsylvania_County_Boundaries.shp\"))\nhospitals <- st_read(file.path(data_path, \"hospitals.geojson\"))\ncensus_tracts <- tracts(state = \"PA\", cb = TRUE)\n\n# Check that all data loaded correctly\nhospitals <- st_transform(hospitals, st_crs(pa_counties))\ncensus_tracts <- st_transform(census_tracts, st_crs(pa_counties))\n\nhead(pa_counties)\nhead(hospitals)\nhead(census_tracts)\n```\n\n```{r}\nnum_hospitals <- nrow(hospitals)\ncat(\"Number of hospitals in dataset:\", num_hospitals, \"\\n\")\n\nnum_tracts <- nrow(census_tracts)\ncat(\"Number of census tracts in dataset:\", num_tracts, \"\\n\")\n\ncat(\"\\n---- Coordinate Reference Systems ----\\n\")\ncat(\"Counties CRS:\\n\"); print(st_crs(pa_counties))\ncat(\"\\nHospitals CRS:\\n\"); print(st_crs(hospitals))\ncat(\"\\nCensus Tracts CRS:\\n\"); print(st_crs(census_tracts))\n```\n\n---\n\n#### Step 2: Get Demographic Data \n\nUse `tidycensus` to download tract-level demographic data for Pennsylvania.\n\n```{r}\n# Get demographic data from ACS\nlibrary(tidycensus)\nlibrary(dplyr)\nlibrary(sf)\n\nacs_year <- 2022\n\npa_basic <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  variables = c(\n    total_pop = \"B01003_001\",\n    median_income = \"B19013_001\"\n  ),\n  year = acs_year,\n  survey = \"acs5\",\n  geometry = FALSE,\n  output = \"wide\"\n)\n\npa_age <- get_acs(\n  geography = \"tract\",\n  state = \"PA\",\n  variables = c(\n    male_65_66 = \"B01001_020\",\n    male_67_69 = \"B01001_021\",\n    male_70_74 = \"B01001_022\",\n    male_75_79 = \"B01001_023\",\n    male_80_84 = \"B01001_024\",\n    male_85plus = \"B01001_025\",\n    female_65_66 = \"B01001_044\",\n    female_67_69 = \"B01001_045\",\n    female_70_74 = \"B01001_046\",\n    female_75_79 = \"B01001_047\",\n    female_80_84 = \"B01001_048\",\n    female_85plus = \"B01001_049\"\n  ),\n  year = acs_year,\n  survey = \"acs5\",\n  geometry = FALSE\n)\n\npa_age_summary <- pa_age %>%\n  group_by(GEOID) %>%\n  summarize(pop_65_over = sum(estimate, na.rm = TRUE))\n\npa_demo <- pa_basic %>%\n  left_join(pa_age_summary, by = \"GEOID\") %>%\n  select(GEOID, total_popE, median_incomeE, pop_65_over) %>%\n  rename(\n    total_pop = total_popE,\n    median_income = median_incomeE\n  )\n\n# Join to tract boundaries\ncensus_tracts_demo <- census_tracts %>%\n  left_join(pa_demo, by = c(\"GEOID\" = \"GEOID\"))\n\n\n# What year of ACS data?\ncat(\"ACS Year Used:\", acs_year, \"\\n\")\n\n# How many tracts have missing income data?\nmissing_income <- sum(is.na(census_tracts_demo$median_income))\ncat(\"Number of tracts with missing income data:\", missing_income, \"\\n\")\n\n# What is the median income across all PA census tracts?\noverall_median_income <- median(census_tracts_demo$median_income, na.rm = TRUE)\ncat(\"Median income across all PA tracts:\", dollar(overall_median_income), \"\\n\")\n\n```\n\n\n---\n\n#### Step 3: Define Vulnerable Populations \n\nIdentify census tracts with vulnerable populations based on TWO criteria:\n1. Low median household income (choose an appropriate threshold)\n2. Significant elderly population (choose an appropriate threshold)\n\n```{r}\n#### Step 3: Define Vulnerable Populations ----\n\nincome_threshold <- 50000\nelderly_threshold <- 0.15\n\ncensus_tracts_demo <- census_tracts_demo %>%\n  mutate(\n    pct_elderly =  pop_65_over/ total_pop\n  )\n\nvulnerable_tracts <- census_tracts_demo %>%\n  filter(\n    median_income < income_threshold &\n    pct_elderly > elderly_threshold\n  )\n\nnum_vulnerable <- nrow(vulnerable_tracts)\ntotal_tracts <- nrow(census_tracts_demo)\npct_vulnerable <- (num_vulnerable / total_tracts) * 100\n\ncat(\"Income threshold:\", income_threshold, \"\\n\")\ncat(\"Elderly population threshold:\", elderly_threshold * 100, \"%\\n\")\ncat(\"Number of vulnerable tracts:\", num_vulnerable, \"\\n\")\ncat(\"Percentage of PA tracts considered vulnerable:\", round(pct_vulnerable, 2), \"%\\n\")\n\n```\n\n---\n\n#### Step 4: Calculate Distance to Hospitals \n\nFor each vulnerable tract, calculate the distance to the nearest hospital.\n\n```{r}\nlibrary(units)\n# Transform to appropriate projected CRS\nprojected_crs <- 26918\n\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts, crs = projected_crs)\nhospitals_proj <- st_transform(hospitals, crs = projected_crs)\n\ntract_centroids <- st_centroid(vulnerable_tracts_proj)\n\ndist_matrix <- st_distance(tract_centroids, hospitals_proj)\nnearest_hospital_dist_m <- apply(dist_matrix, 1, min)\n\nnearest_hospital_dist_miles <- as.numeric(nearest_hospital_dist_m) / 1609.34\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(distance_to_hospital_miles = nearest_hospital_dist_miles)\n\navg_distance <- mean(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nmax_distance <- max(vulnerable_tracts_proj$distance_to_hospital_miles, na.rm = TRUE)\nnum_over_15 <- sum(vulnerable_tracts_proj$distance_to_hospital_miles > 15, na.rm = TRUE)\n\ncat(\"Average distance to nearest hospital (miles):\", round(avg_distance, 2), \"\\n\")\ncat(\"Maximum distance to nearest hospital (miles):\", round(max_distance, 2), \"\\n\")\ncat(\"Number of vulnerable tracts >15 miles from hospital:\", num_over_15, \"\\n\")\n\n```\n\n---\n\n#### Step 5: Identify Underserved Areas \n\nDefine \"underserved\" as vulnerable tracts that are more than 15 miles from the nearest hospital.\n\n```{r}\n# Create underserved variable\n\nlibrary(dplyr)\n\nvulnerable_tracts_proj <- vulnerable_tracts_proj %>%\n  mutate(\n    underserved = distance_to_hospital_miles > 15\n  )\n\nnum_underserved <- sum(vulnerable_tracts_proj$underserved, na.rm = TRUE)\ntotal_vulnerable <- nrow(vulnerable_tracts_proj)\npct_underserved <- (num_underserved / total_vulnerable) * 100\n\ncat(\"Number of underserved vulnerable tracts:\", num_underserved, \"\\n\")\ncat(\"Percentage of vulnerable tracts that are underserved:\", round(pct_underserved, 2), \"%\\n\")\n\n```\n\n---\n\n#### Step 6: Aggregate to County Level\n\nUse spatial joins and aggregation to calculate county-level statistics about vulnerable populations and hospital access.\n\n```{r}\n# Spatial join tracts to counties\n#### Step 6: Aggregate to County Level ----\n\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts_proj, st_crs(pa_counties))\n\ntracts_with_county <- st_join(vulnerable_tracts_proj, pa_counties, join = st_intersects, left = FALSE)\n\nnames(tracts_with_county)\n\ncounty_summary <- tracts_with_county %>%\n  st_drop_geometry() %>%\n  group_by(NAMELSADCO) %>%\n  summarize(\n    num_vulnerable_tracts = n(),\n    num_underserved_tracts = sum(underserved, na.rm = TRUE),\n    pct_underserved = (num_underserved_tracts / num_vulnerable_tracts) * 100,\n    avg_distance_miles = mean(distance_to_hospital_miles, na.rm = TRUE),\n    total_vulnerable_pop = sum(total_pop, na.rm = TRUE)\n  ) %>%\n  arrange(desc(pct_underserved))\n\nhead(county_summary)\n\n# Aggregate statistics by county\n\n```\n\n\n```{r}\ntop5_underserved <- county_summary %>%\n  arrange(desc(pct_underserved)) %>%\n  slice(1:5)\nprint(top5_underserved)\n\n```\n```{r}\ntop_vuln_far <- county_summary %>%\n  arrange(desc(total_vulnerable_pop)) %>%\n  slice(1:5)\nprint(top_vuln_far)\n\n```\nMost underserved counties tend to be located in rural northern and western Pennsylvania, where hospital density is lower and population centers are more dispersed. Urban counties (like Philadelphia or Allegheny) show fewer underserved tracts due to higher hospital accessibility.\n\n---\n\n#### Step 7: Create Summary Table \n\nCreate a professional table showing the top 10 priority counties for healthcare investment.\n\n```{r}\n# Create and format priority counties table\n#### Step 7: Create Summary Table ----\n\nlibrary(knitr)\nlibrary(scales)\n\npriority_metric <- \"pct_underserved\"\n\npriority_counties <- county_summary %>%\n  arrange(desc(!!sym(priority_metric))) %>%\n  slice(1:10) %>%\n  mutate(\n    num_vulnerable_tracts = comma(num_vulnerable_tracts),\n    num_underserved_tracts = comma(num_underserved_tracts),\n    pct_underserved = percent(pct_underserved / 100, accuracy = 0.1),\n    avg_distance_miles = round(avg_distance_miles, 1),\n    total_vulnerable_pop = comma(total_vulnerable_pop)\n  ) %>%\n  rename(\n    `County` = NAMELSADCO,\n    `Vulnerable Tracts` = num_vulnerable_tracts,\n    `Underserved Tracts` = num_underserved_tracts,\n    `% Underserved` = pct_underserved,\n    `Avg Distance (mi)` = avg_distance_miles,\n    `Total Vulnerable Population` = total_vulnerable_pop\n  )\n\nkable(\n  priority_counties,\n  caption = \"Table 1. Top 10 Pennsylvania Counties Prioritized for Healthcare Investment\",\n  align = \"lccccc\",\n  format = \"markdown\"\n)\n\n```\n\n---\n\n## Part 2: Comprehensive Visualization \n\nUsing the skills from Week 3 (Data Visualization), create publication-quality maps and charts.\n\n### Map 1: County-Level Choropleth \n\nCreate a choropleth map showing healthcare access challenges at the county level.\n\n```{r}\nlibrary(stringr)\n\ncounty_summary <- county_summary %>%\n  mutate(NAMELSADCO = str_replace(NAMELSADCO, \" County$\", \"\"))\n\n```\n\n```{r}\nView(pa_counties)\nView(county_summary)\n```\n\n\n```{r}\n# Create county-level access map\n#### Part 2: County-Level Choropleth ----\n\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(scales)\n\npa_counties_proj <- st_transform(pa_counties, 26918)\nhospitals_proj <- st_transform(hospitals, 26918)\n\n\ncounty_summary_map <- pa_counties_proj %>%\n  mutate(COUNTY_NAM = tolower(COUNTY_NAM)) %>%\n  left_join(\n    county_summary %>%\n      mutate(NAMELSADCO = tolower(NAMELSADCO)),\n    by = c(\"COUNTY_NAM\" = \"NAMELSADCO\")\n  )\n\n\nggplot() +\n  geom_sf(\n    data = county_summary_map,\n    aes(fill = pct_underserved),\n    color = \"white\",\n    size = 0.2\n  ) +\n\n  scale_fill_gradient(\n    low = \"#DEEBF7\",\n    high = \"#2171B5\",\n    name = \"% Underserved Tracts\",\n    labels = function(x) paste0(round(x, 0), \"%\"),\n    na.value = \"grey90\"\n  ) +\n\n  labs(\n    title = \"Healthcare Access Challenges Across Pennsylvania Counties\",\n    subtitle = \"Percentage of vulnerable tracts that are more than 15 miles from the nearest hospital\",\n    caption = \"Data sources: ACS 2022 (via tidycensus), Pennsylvania hospital data (Week 4 lecture)\"\n  ) +\n\n  theme_void(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 11, hjust = 0.5),\n    plot.caption = element_text(size = 9, hjust = 0.95, color = \"gray40\"),\n    legend.position = \"right\",\n    legend.title = element_text(size = 10, face = \"bold\"),\n    legend.text = element_text(size = 9)\n  )\n\n\n\n```\n\n---\n\n### Map 2: Detailed Vulnerability Map \n\nCreate a map highlighting underserved vulnerable tracts.\n\n```{r}\n# Create detailed tract-level map\n#### Part 2: Map 2 - Detailed Vulnerability Map ----\n\npa_counties_proj <- st_transform(pa_counties, 26918)\nhospitals_proj <- st_transform(hospitals, 26918)\nvulnerable_tracts_proj <- st_transform(vulnerable_tracts_proj, 26918)\n\ntract_map_data <- vulnerable_tracts_proj %>%\n  mutate(\n    tract_status = case_when(\n      underserved ~ \"Underserved Vulnerable Tract\",\n      TRUE ~ \"Other Vulnerable Tract\"\n    )\n  )\n\nggplot() +\n  geom_sf(data = pa_counties_proj, fill = \"gray95\", color = \"white\", size = 0.3) +\n  \n  geom_sf(\n    data = tract_map_data,\n    aes(fill = tract_status),\n    color = NA,\n    alpha = 0.9\n  ) +\n  \n  geom_sf(\n    data = hospitals_proj,\n    color = \"red\",\n    size = 1.2,\n    alpha = 0.8\n  ) +\n  \n  scale_fill_manual(\n    values = c(\n      \"Underserved Vulnerable Tract\" = \"#d73027\",\n      \"Other Vulnerable Tract\" = \"#fee090\"\n    ),\n    name = \"Tract Type\"\n  ) +\n  \n  labs(\n    title = \"Underserved Vulnerable Tracts in Pennsylvania\",\n    subtitle = \"Vulnerable tracts (low income & elderly) more than 15 miles from the nearest hospital are shown in red\",\n    caption = \"Data: ACS 2022 (via tidycensus) and PA hospital data (Week 4 lecture)\"\n  ) +\n  \n  theme_void(base_size = 11) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 11, hjust = 0.5, color = \"gray20\"),\n    plot.caption = element_text(size = 9, color = \"gray40\", hjust = 0.95),\n    legend.position = \"bottom\",\n    legend.title = element_text(face = \"bold\", size = 10),\n    legend.text = element_text(size = 9)\n  )\n\n```\n\n---\n\n### Chart: Distribution Analysis\n\nCreate a visualization showing the distribution of distances to hospitals for vulnerable populations.\n\n```{r}\n# Create distribution visualization\n#### Chart: Distribution Analysis ----\n\nlibrary(ggplot2)\nlibrary(scales)\n\nggplot(vulnerable_tracts_proj, aes(x = distance_to_hospital_miles)) +\n  geom_histogram(\n    aes(y = after_stat(density)),\n    bins = 30,\n    fill = \"#74c476\",\n    color = \"white\",\n    alpha = 0.8\n  ) +\n  geom_density(color = \"#006d2c\", linewidth = 1) +\n  geom_vline(xintercept = 15, linetype = \"dashed\", color = \"red\", linewidth = 1) +\n  labs(\n    title = \"Distribution of Distances to Nearest Hospital for Vulnerable Tracts\",\n    subtitle = \"Dashed red line indicates the 15-mile underserved threshold\",\n    x = \"Distance to Nearest Hospital (miles)\",\n    y = \"Density\",\n    caption = \"Data: ACS 2022 (via tidycensus) and PA hospital data (Week 4 lecture)\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n    plot.subtitle = element_text(size = 11, hjust = 0.5, color = \"gray30\"),\n    plot.caption = element_text(size = 9, color = \"gray40\", hjust = 0.95),\n    axis.title = element_text(face = \"bold\")\n  )\n\n\n\n\n```\n\n---\n\n## Part 3: Bring Your Own Data Analysis \n\nChoose your own additional spatial dataset and conduct a supplementary analysis.\n\n1. **Find and load additional data**\n   - Document your data source\n   - Check and standardize the CRS\n   - Provide basic summary statistics\n\n```{r}\n# Load your additional dataset\nbase_path = \"D:\\\\Desktop\\\\musa\\\\5080_policy\\\\portfolio-setup-xqdqc-hub\\\\assignments\\\\assignment_2\\\\data\"\n\nschools <- st_read(file.path(base_path, \"Schools\\\\Schools.shp\"))\ncrime <- st_read(file.path(base_path,\"incidents_part1_part2\\\\incidents_part1_part2.shp\"))\nbike_net <- st_read(file.path(base_path,\"Bike_Network\\\\Bike_Network.shp\"))\n```\n```{r}\ncat(\"Schools CRS:\\n\"); print(st_crs(schools))\ncat(\"\\nCrime Incidents CRS:\\n\"); print(st_crs(crime))\ncat(\"\\nBike Network CRS:\\n\"); print(st_crs(bike_net))\n```\n```{r}\ncrime <- st_transform(crime, 3857)\n```\n\n```{r}\ncat(\"\\nSchools:\\n\")\ncat(\"Number of schools:\", nrow(schools), \"\\n\")\nprint(st_geometry_type(schools) %>% table())\nprint(summary(st_bbox(schools)))\n\ncat(\"\\nCrime Incidents:\\n\")\ncat(\"Number of records:\", nrow(crime), \"\\n\")\nprint(st_geometry_type(crime) %>% table())\nprint(summary(st_bbox(crime)))\n\ncat(\"\\nBike Network:\\n\")\ncat(\"Number of segments:\", nrow(bike_net), \"\\n\")\nprint(st_geometry_type(bike_net) %>% table())\nprint(summary(st_bbox(bike_net)))\n```\n\n**Questions to answer:**\n- What dataset did you choose and why?\n\nI have chosen School dataset because I'm interested in young children issue.\n\n- What is the data source and date?\n\nCrime Incidents is in 2024, and I also have school dataset and bike network dataset.\n\n- How many features does it contain?\n\nNumber of schools is 495, number of crime records is 160388, number of bike network segments is 5225.\n\n- What CRS is it in? Did you need to transform it?\n\nThe CRS of schools and bike network data is EPSG 3857, the CRS of crime data is EPSG 4326. So I have got crime data transformed.\n\n---\n\n2. **Pose a research question**\n\nWrite a clear research statement that your analysis will answer.\n\nThis analysis investigates whether school zones in Philadelphia are safe environments, by examining the number of nearby crime incidents.\n\n---\n\n3. **Conduct spatial analysis**\n\n```{r}\n# Your spatial analysis\nschool_buffers <- st_buffer(schools, dist = 1000)\n\ncrime_join <- st_join(crime, school_buffers, join = st_within, left = FALSE)\n```\n\n```{r}\nView(crime_join)\n```\n\n\n```{r}\nschool_crime_count <- crime_join %>%\n  st_drop_geometry() %>%\n  group_by(school_nam) %>%\n  summarize(crime_count = n())\n\nschools_with_crime <- schools %>%\n  left_join(school_crime_count, by = \"school_nam\") %>%\n  mutate(crime_count = replace_na(crime_count, 0))\n```\n\n```{r}\nhead(schools_with_crime)\n```\n\n```{r}\nbike_in_buffers <- st_intersection(bike_net, school_buffers)\n\nbike_coverage <- bike_in_buffers %>%\n  st_drop_geometry() %>%\n  group_by(school_nam) %>%\n  summarize(bike_miles = sum(st_length(bike_in_buffers) / 5280))\n\nschools_with_bike <- schools_with_crime %>%\n  left_join(bike_coverage, by = c(\"school_nam\")) %>%\n  mutate(bike_miles = replace_na(bike_miles))\n\nhead(schools_with_bike)\n```\n\n\n```{r}\nsummary_tbl <- schools_with_bike %>%\n  st_drop_geometry() %>%\n  summarize(\n    total_schools = n(),\n    avg_crime = mean(crime_count, na.rm = TRUE),\n    avg_bike = mean(bike_miles, na.rm = TRUE)\n  )\n\nprint(summary_tbl)\n```\n\n\n\n```{r}\nggplot(data = schools_with_crime) +\n  geom_sf(aes(color = crime_count), size = 2) +\n  scale_color_viridis_c(\n    option = \"plasma\",\n    trans = \"sqrt\",\n    name = \"Crime Count\"\n  ) +\n  labs(\n    title = \"Crime Incidents Within 1000ft of Philadelphia Schools\",\n    subtitle = \"Each point represents a school, colored by number of nearby crime incidents\",\n    caption = \"Data: OpenDataPhilly | Analysis: MUSA 5080 Assignment 3\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 10, hjust = 0.5, color = \"gray30\"),\n    legend.position = \"right\"\n  )\n\n```\n\n\n```{r}\nggplot(schools_with_crime, aes(x = crime_count)) +\n  geom_histogram(\n    bins = 30,\n    fill = \"pink\",\n    color = \"white\",\n    alpha = 0.8\n  ) +\n  labs(\n    title = \"Distribution of Crime Incidents Within 1000ft of Schools\",\n    subtitle = \"Each bar represents the number of schools by nearby crime count\",\n    x = \"Number of Crime Incidents (within 1000ft)\",\n    y = \"Number of Schools\",\n    caption = \"Data: OpenDataPhilly | Analysis: MUSA 5080 Assignment 3\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14, hjust = 0.5),\n    plot.subtitle = element_text(size = 10, hjust = 0.5, color = \"gray30\"),\n    plot.caption = element_text(size = 8, color = \"gray50\", hjust = 0.95)\n  )\n\n```\n\n**My interpretation:**\nThe majority of Philadelphia schools experience a moderate number of nearby crime incidents, with most falling below 2,000 cases within a 1,000-ft radius. However, a few schools stand out as clear hotspots, with significantly higher counts exceeding 6,000 incidents, concentrated primarily in central and southern parts of the city. The histogram confirms this right-skewed distribution, where a small proportion of schools account for a disproportionately large share of nearby crimes. These findings suggest that while most school zones remain relatively safe, targeted safety interventions and “Safe Routes to School” programs should prioritize the high-crime areas identified in the analysis.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"embed-resources":true,"output-file":"Qianmu_Zheng_assignment2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"cosmo","title":"Assignment 2: Spatial Analysis and Visualization","subtitle":"Healthcare Access and Equity in Pennsylvania","author":"Qianmu Zheng","date":"today","toc-location":"left"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}